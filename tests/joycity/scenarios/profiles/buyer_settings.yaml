steps:
  # Регистрация buyer
  - type: http
    method: POST
    path: /api/v1/auth/register
    headers:
      Accept: application/json
      Content-Type: application/json
    body:
      email: faker.email:buyer_email
      password: faker.password:buyer_password
      confirm_password: faker.password:buyer_password
      phone_number: phone_number:buyer_phone
      organization_name: faker.company:buyer_org
      surname: surname:buyer_surname
      name: first_name:buyer_name
      role: buyer
      phone_country_code: "RU"
      telegram: faker.userName:buyer_telegram
      device_fingerprint: optional-device-fp
      country: "Россия"
      city: "Москва"
      address: "ул. Тестовая, д. 1"
    extract:
      buyer_user_id: data.response.uuid
      buyer_access_token: data.response.access_token

  # Логин buyer
  - type: http
    method: POST
    path: /api/v1/auth/login
    headers:
      Accept: application/json
      Content-Type: application/json
    body:
      email: "{{buyer_email}}"
      password: "{{buyer_password}}"
      role: buyer
      device_fingerprint: optional-device-fp
    extract:
      login_token: data.response.access_token

  # GET /api/v1/buyer/settings/self - получить настройки
  - type: http
    method: GET
    path: /api/v1/buyer/settings/self
    headers:
      Accept: application/json
      Authorization: "Bearer {{login_token}}"

  # PUT /api/v1/buyer/settings/set-categories - установить категории
  - type: http
    method: PUT
    path: /api/v1/buyer/settings/set-categories
    headers:
      Accept: application/json
      Content-Type: application/json
      Authorization: "Bearer {{login_token}}"
    body:
      category_ids: [1, 2, 3]

  # PUT /api/v1/buyer/settings/set-delivery - настройки доставки
  - type: http
    method: PUT
    path: /api/v1/buyer/settings/set-delivery
    headers:
      Accept: application/json
      Content-Type: application/json
      Authorization: "Bearer {{login_token}}"
    body:
      delivery_ids: [10, 20, 30]

  # PUT /api/v1/buyer/settings/set-packaging - настройки упаковки
  - type: http
    method: PUT
    path: /api/v1/buyer/settings/set-packaging
    headers:
      Accept: application/json
      Content-Type: application/json
      Authorization: "Bearer {{login_token}}"
    body:
      packaging_ids: [100, 200, 300]

  # PUT /api/v1/buyer/settings/update - обновить общие настройки
  - type: http
    method: PUT
    path: /api/v1/buyer/settings/update
    headers:
      Accept: application/json
      Content-Type: application/json
      Authorization: "Bearer {{login_token}}"
    body:
      enable_notifications: true
      currency: "USD"
      application_language: "en"
      chat_language: "en"
      selected_categories: [1, 2, 3]

  # GET /api/v1/buyer/settings/self - проверить финальное состояние
  - type: http
    method: GET
    path: /api/v1/buyer/settings/self
    headers:
      Accept: application/json
      Authorization: "Bearer {{login_token}}"
