steps:
  # Регистрация fulfillment
  - type: http
    method: POST
    path: /api/v1/auth/register
    headers:
      Accept: application/json
      Content-Type: application/json
    body:
      email: faker.email:fulfillment_email
      password: faker.password:fulfillment_password
      confirm_password: faker.password:fulfillment_password
      phone_number: phone_number:fulfillment_phone
      organization_name: faker.company:fulfillment_org
      surname: surname:fulfillment_surname
      name: first_name:fulfillment_name
      role: fulfillment
      phone_country_code: "RU"
      telegram: faker.userName:fulfillment_telegram
      device_fingerprint: optional-device-fp
      country: "Россия"
      city: "Санкт-Петербург"
      address: "ул. Тестовая, д. 2"
    extract:
      fulfillment_user_id: data.response.uuid
      fulfillment_access_token: data.response.access_token

  # Логин fulfillment
  - type: http
    method: POST
    path: /api/v1/auth/login
    headers:
      Accept: application/json
      Content-Type: application/json
    body:
      email: "{{fulfillment_email}}"
      password: "{{fulfillment_password}}"
      role: fulfillment
      device_fingerprint: optional-device-fp
    extract:
      login_token: data.response.access_token
      login_user_id: data.response.uuid

  # GET /api/v1/fulfillment/profile/self - получить данные своего профиля
  - type: http
    method: GET
    path: /api/v1/fulfillment/profile/self
    headers:
      Accept: application/json
      Authorization: "Bearer {{login_token}}"

  # PUT /api/v1/fulfillment/profile/update - обновить имя и фамилию
  - type: http
    method: PUT
    path: /api/v1/fulfillment/profile/update
    headers:
      Accept: application/json
      Content-Type: application/json
      Authorization: "Bearer {{login_token}}"
    body:
      name: "Сидор"
      surname: "Сидоров"

  # PUT /api/v1/fulfillment/profile/update - обновить телефон
  - type: http
    method: PUT
    path: /api/v1/fulfillment/profile/update
    headers:
      Accept: application/json
      Content-Type: application/json
      Authorization: "Bearer {{login_token}}"
    body:
      phone_number: phone_number:updated_phone
      phone_country_code: "RU"

  # PUT /api/v1/fulfillment/profile/update - обновить организацию
  - type: http
    method: PUT
    path: /api/v1/fulfillment/profile/update
    headers:
      Accept: application/json
      Content-Type: application/json
      Authorization: "Bearer {{login_token}}"
    body:
      organization_name: "Склад Фулфилмент"

  # PUT /api/v1/fulfillment/profile/update - обновить город и страну
  - type: http
    method: PUT
    path: /api/v1/fulfillment/profile/update
    headers:
      Accept: application/json
      Content-Type: application/json
      Authorization: "Bearer {{login_token}}"
    body:
      city: "Санкт-Петербург"
      country: "Россия"

  # GET /api/v1/fulfillment/profile/self - проверить финальное состояние
  - type: http
    method: GET
    path: /api/v1/fulfillment/profile/self
    headers:
      Accept: application/json
      Authorization: "Bearer {{login_token}}"

  # POST /api/v1/fulfillment/profile/upload-avatar - загрузить аватар
  - type: http
    method: POST
    path: /api/v1/fulfillment/profile/upload-avatar
    headers:
      Accept: application/json
      Content-Type: multipart/form-data
      Authorization: "Bearer {{login_token}}"
    body:
      images:
        - "file:/Users/andrewmaster/www/sandbox/test-avatar.png"

  # DELETE /api/v1/fulfillment/profile/delete - удалить профиль
  - type: http
    method: DELETE
    path: /api/v1/fulfillment/profile/delete
    headers:
      Accept: application/json
      Authorization: "Bearer {{login_token}}"
