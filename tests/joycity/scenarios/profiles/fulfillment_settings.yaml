steps:
  # Регистрация fulfillment
  - type: http
    method: POST
    path: /api/v1/auth/register
    headers:
      Accept: application/json
      Content-Type: application/json
    body:
      email: faker.email:fulfillment_email
      password: faker.password:fulfillment_password
      confirm_password: faker.password:fulfillment_password
      phone_number: phone_number:fulfillment_phone
      organization_name: faker.company:fulfillment_org
      surname: surname:fulfillment_surname
      name: first_name:fulfillment_name
      role: fulfillment
      phone_country_code: "RU"
      telegram: faker.userName:fulfillment_telegram
      device_fingerprint: optional-device-fp
      country: "Россия"
      city: "Санкт-Петербург"
      address: "ул. Тестовая, д. 2"
    extract:
      fulfillment_user_id: data.response.uuid
      fulfillment_access_token: data.response.access_token

  # Логин fulfillment
  - type: http
    method: POST
    path: /api/v1/auth/login
    headers:
      Accept: application/json
      Content-Type: application/json
    body:
      email: "{{fulfillment_email}}"
      password: "{{fulfillment_password}}"
      role: fulfillment
      device_fingerprint: optional-device-fp
    extract:
      login_token: data.response.access_token

  # GET /api/v1/fulfillment/settings/self - получить настройки
  - type: http
    method: GET
    path: /api/v1/fulfillment/settings/self
    headers:
      Accept: application/json
      Authorization: "Bearer {{login_token}}"

  # PUT /api/v1/fulfillment/settings/update - обновить настройки
  - type: http
    method: PUT
    path: /api/v1/fulfillment/settings/update
    headers:
      Accept: application/json
      Content-Type: application/json
      Authorization: "Bearer {{login_token}}"
    body:
      enable_notifications: true
      currency: "USD"
      application_language: "en"
      chat_language: "en"
      high_workload: false
      delivery_point_address: "Some address, city"

  # GET /api/v1/fulfillment/settings/self - проверить финальное состояние
  - type: http
    method: GET
    path: /api/v1/fulfillment/settings/self
    headers:
      Accept: application/json
      Authorization: "Bearer {{login_token}}"
