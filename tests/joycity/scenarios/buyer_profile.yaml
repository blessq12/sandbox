steps:
  # Регистрация buyer
  - type: http
    method: POST
    path: /api/v1/auth/register
    headers:
      Accept: application/json
      Content-Type: application/json
    body:
      email: faker.email:buyer_email
      password: faker.password:buyer_password
      confirm_password: faker.password:buyer_password
      phone_number: phone_number:buyer_phone
      organization_name: faker.company:buyer_org
      surname: surname:buyer_surname
      name: first_name:buyer_name
      role: buyer
      phone_country_code: "RU"
      telegram: faker.userName:buyer_telegram
      device_fingerprint: optional-device-fp
      country: "Россия"
      city: "Москва"
      address: "ул. Тестовая, д. 1"
    extract:
      buyer_user_id: data.response.uuid
      buyer_access_token: data.response.access_token

  # Логин buyer
  - type: http
    method: POST
    path: /api/v1/auth/login
    headers:
      Accept: application/json
      Content-Type: application/json
    body:
      email: "{{buyer_email}}"
      password: "{{buyer_password}}"
      role: buyer
      device_fingerprint: optional-device-fp
    extract:
      login_token: data.response.access_token
      login_user_id: data.response.uuid

  # GET /api/v1/buyer/profile/self - получить данные своего профиля
  - type: http
    method: GET
    path: /api/v1/buyer/profile/self
    headers:
      Accept: application/json
      Authorization: "Bearer {{login_token}}"

  # PUT /api/v1/buyer/profile/update - обновить профиль
  - type: http
    method: PUT
    path: /api/v1/buyer/profile/update
    headers:
      Accept: application/json
      Content-Type: application/json
      Authorization: "Bearer {{login_token}}"
    body:
      name: "Иван"
      surname: "Иванов"
      phone_number: phone_number:updated_phone
      organization_name: "ООО Продавец"
      phone_country_code: "RU"
      address: "ул. Пушкина, д. 1"
      city: "Москва"
      country: "Россия"
      description: "Описание продавца и услуг"

  # POST /api/v1/buyer/profile/upload-avatar - загрузить аватар
  - type: http
    method: POST
    path: /api/v1/buyer/profile/upload-avatar
    headers:
      Accept: application/json
      Content-Type: multipart/form-data
      Authorization: "Bearer {{login_token}}"
    body:
      images:
        - "file:/Users/andrewmaster/www/sandbox/test-avatar.png"

  # DELETE /api/v1/buyer/profile/delete - удалить профиль
  - type: http
    method: DELETE
    path: /api/v1/buyer/profile/delete
    headers:
      Accept: application/json
      Authorization: "Bearer {{login_token}}"
